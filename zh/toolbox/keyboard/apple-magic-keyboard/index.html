<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>专业版 Mac 键盘测试 · 精准连点预警</title>
    
    <!-- 共用样式 (保留原框架) -->
    <link rel="stylesheet" href="/static/css/shared/BreadNav.css">
    <link rel="stylesheet" href="/static/css/shared/NavCard.css">
    <link rel="stylesheet" href="/static/css/shared/toolsnavigation.css">
    <link rel="stylesheet" href="/static/css/shared/switchlanguage.css">
    <link rel="stylesheet" href="/static/css/shared/document.css">
    <link rel="stylesheet" href="/static/css/toolbox/keyboard/apple-magic-keyboard/style.css">
</head>
<body>
    <div class="tester-container">
        <header>
            <h1>⚡ Mac 键盘诊断台 <span style="font-size: 1rem; background: none; -webkit-text-fill-color: #4a5b6b;">(精准连点预警)</span></h1>
            <div class="status-panel">
                <div class="stat-item">最近按键: <span id="last-key">-</span></div>
                <div class="stat-item">KeyCode: <span id="key-code">-</span></div>
                <div class="concurrent-badge" id="concurrent-info">当前:0 最大:0</div>
                <button id="reset-btn">⟲ 重置测试</button>
            </div>
        </header>

        <div class="info-row">
            <div class="key-detail">⌨️ Key: <span id="info-key">—</span></div>
            <div class="key-detail">🆔 Code: <span id="info-code">—</span></div>
            <div class="key-detail">🔢 Which: <span id="info-which">—</span></div>
        </div>

        <!-- 键盘布局 (ID 与脚本严格对应) -->
        <div class="keyboard-iso" id="keyboard">
            <!-- 功能键行：F1–F12 + Touch ID（原 Power 键改为此样式） -->
            <div class="row function-row">
                <div class="key esc" id="Escape"><span>esc</span></div>
                <div class="key" id="F1"><span>F1</span></div>
                <div class="key" id="F2"><span>F2</span></div>
                <div class="key" id="F3"><span>F3</span></div>
                <div class="key" id="F4"><span>F4</span></div>
                <div class="key" id="F5"><span>F5</span></div>
                <div class="key" id="F6"><span>F6</span></div>
                <div class="key" id="F7"><span>F7</span></div>
                <div class="key" id="F8"><span>F8</span></div>
                <div class="key" id="F9"><span>F9</span></div>
                <div class="key" id="F10"><span>F10</span></div>
                <div class="key" id="F11"><span>F11</span></div>
                <div class="key" id="F12"><span>F12</span></div>
                <div class="key" id="Power"><span>⬤</span></div>  <!-- Touch ID 传感器 -->
            </div>

            <!-- 数字符号行（不变） -->
            <div class="row">
                <div class="key" id="Backquote"><span>~</span><span>`</span></div>
                <div class="key" id="Digit1"><span>!</span><span>1</span></div>
                <div class="key" id="Digit2"><span>@</span><span>2</span></div>
                <div class="key" id="Digit3"><span>#</span><span>3</span></div>
                <div class="key" id="Digit4"><span>$</span><span>4</span></div>
                <div class="key" id="Digit5"><span>%</span><span>5</span></div>
                <div class="key" id="Digit6"><span>^</span><span>6</span></div>
                <div class="key" id="Digit7"><span>&</span><span>7</span></div>
                <div class="key" id="Digit8"><span>*</span><span>8</span></div>
                <div class="key" id="Digit9"><span>(</span><span>9</span></div>
                <div class="key" id="Digit0"><span>)</span><span>0</span></div>
                <div class="key" id="Minus"><span>_</span><span>-</span></div>
                <div class="key" id="Equal"><span>+</span><span>=</span></div>
                <div class="key delete" id="Backspace"><span>delete</span></div>
            </div>

            <!-- 第二排字母行（Q–]，return） -->
            <div class="row">
                <div class="key tab" id="Tab"><span>tab</span></div>
                <div class="key" id="KeyQ"><span>Q</span></div>
                <div class="key" id="KeyW"><span>W</span></div>
                <div class="key" id="KeyE"><span>E</span></div>
                <div class="key" id="KeyR"><span>R</span></div>
                <div class="key" id="KeyT"><span>T</span></div>
                <div class="key" id="KeyY"><span>Y</span></div>
                <div class="key" id="KeyU"><span>U</span></div>
                <div class="key" id="KeyI"><span>I</span></div>
                <div class="key" id="KeyO"><span>O</span></div>
                <div class="key" id="KeyP"><span>P</span></div>
                <div class="key" id="BracketLeft"><span>{</span><span>[</span></div>
                <div class="key" id="BracketRight"><span>}</span><span>]</span></div>
                <div class="key enter-upper" id="Enter"><span>return</span></div>
            </div>

            <!-- 第三排字母行（caps, A–L, ; ' \） -->
            <div class="row">
                <div class="key capslock" id="CapsLock"><span>⇪</span><span>caps</span></div>  <!-- Mac 风格 Caps Lock -->
                <div class="key" id="KeyA"><span>A</span></div>
                <div class="key" id="KeyS"><span>S</span></div>
                <div class="key" id="KeyD"><span>D</span></div>
                <div class="key" id="KeyF"><span>F</span></div>
                <div class="key" id="KeyG"><span>G</span></div>
                <div class="key" id="KeyH"><span>H</span></div>
                <div class="key" id="KeyJ"><span>J</span></div>
                <div class="key" id="KeyK"><span>K</span></div>
                <div class="key" id="KeyL"><span>L</span></div>
                <div class="key" id="Semicolon"><span>:</span><span>;</span></div>
                <div class="key" id="Quote"><span>"</span><span>'</span></div>
                <div class="key" id="Backslash"><span>|</span><span>\</span></div>
            </div>

            <!-- 第四排字母行（shift, Z–M, , . / shift） 移除 IntlBackslash -->
            <div class="row">
                <div class="key shift-left" id="ShiftLeft"><span>shift</span></div>
                <!-- IntlBackslash 已删除，左 Shift 直接邻接 Z -->
                <div class="key" id="KeyZ"><span>Z</span></div>
                <div class="key" id="KeyX"><span>X</span></div>
                <div class="key" id="KeyC"><span>C</span></div>
                <div class="key" id="KeyV"><span>V</span></div>
                <div class="key" id="KeyB"><span>B</span></div>
                <div class="key" id="KeyN"><span>N</span></div>
                <div class="key" id="KeyM"><span>M</span></div>
                <div class="key" id="Comma"><span><</span><span>,</span></div>
                <div class="key" id="Period"><span>></span><span>.</span></div>
                <div class="key" id="Slash"><span>?</span><span>/</span></div>
                <div class="key shift-right" id="ShiftRight"><span>shift</span></div>
            </div>

            <!-- 底行：fn, control, option, command, 空格, 右侧 command, option, 以及四个独立箭头键（全高） -->
            <div class="row">
                <div class="key fn" id="Fn"><span>fn</span></div>
                <div class="key control" id="ControlLeft"><span>control</span><span>⌃</span></div>
                <div class="key option" id="OptionLeft"><span>option</span><span>⌥</span></div>
                <div class="key command" id="MetaLeft"><span>command</span><span>⌘</span></div>
                <div class="key space" id="Space"><span></span></div>
                <div class="key command" id="MetaRight"><span>command</span><span>⌘</span></div>
                <div class="key option" id="OptionRight"><span>option</span><span>⌥</span></div>
                <!-- 四个独立箭头键，全高，使用 arrow 类以便样式统一 -->
                <div class="key arrow" id="ArrowLeft"><span>◀</span></div>
                <div class="key arrow" id="ArrowUp"><span>▲</span></div>
                <div class="key arrow" id="ArrowDown"><span>▼</span></div>
                <div class="key arrow" id="ArrowRight"><span>▶</span></div>
            </div>
        </div>

        <div class="log-panel">
            <div class="log-header">
                <span>📋 故障诊断日志 (连点阈值 <80ms 红色预警 · 长按无日志)</span>
                <button id="clear-log">清除日志</button>
            </div>
            <div id="log-entries" class="log-entries">
                <div class="log-entry"><span class="timestamp">⏱️</span> 初始化日志，开始测试 (↓按下/↑松开)</div>
            </div>
        </div>
    </div>

    <!-- 本地脚本 (保留原有核心逻辑) -->
    <script src="/static/js/toolbox/keyboard/apple-magic-keyboard/script-zh.js"></script>
    <!-- 原有共享脚本 (可选依赖) -->
    <script src="/static/js/shared/switchlanguage.js"></script>
</body>
</html>